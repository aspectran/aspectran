<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE aspectran PUBLIC "-//ASPECTRAN//DTD Aspectran Configuration 6.0//EN"
        "http://aspectran.github.io/dtd/aspectran-6.dtd">
<aspectran>

    <description style="apon">
        |Commands that can run the examples:
        |   hello     Runs the helloWorld() method of the sampleAction bean and prints the returned value to the console.
        |   echo      It accepts parameters and print them to the console.
        |   login     It accepts parameters used for login and print them to the console.
        |   chpw      It accepts parameters for changing the password and print them to the console.
        |   free      It uses the Freemarker template engine to output the values of the input parameters to the console.
        |   select    This example generates a simple SQL SELECT statement using the Freemarker template engine.
        |   update    This example generates a simple SQL UPDATE statement using the Freemarker template engine.
        |
    </description>

    <bean id="sampleAction" class="com.aspectran.shell.sample.SampleAction">
        <description>
            Defines one sample action that contains the helloWorld method.
        </description>
    </bean>

    <bean id="sampleAdvice" class="com.aspectran.shell.sample.SampleAdvice">
        <description>
            Action Method 실행 전 후에 주입할 Advice Action Method를 가지고 있는
            singleton 스코프를 가지는 Bean을 정의합니다.
        </description>
    </bean>

    <bean id="currentActivityData" class="com.aspectran.core.support.CurrentActivityDataFactoryBean" scope="request"/>

    <aspect id="sampleAdviceAspect">
        <description>
            sampleAction Bean의 helloWorld 메쏘드를 실행하는 Translet이 발견되면,
            해당 Translet의 실행 전에는 sampleAdvice Bean의 welcome 메쏘드를 실행하고,
            해당 Translet의 실행 후에는 sampleAdvice Bean의 goodbye 메쏘드를 실행합니다.
        </description>
        <joinpoint target="translet">
            pointcut: {
                +: hello@sampleAction^helloWorld
            }
        </joinpoint>
        <advice bean="sampleAdvice">
            <before>
                <action method="welcome"/>
            </before>
            <after>
                <action method="goodbye"/>
            </after>
        </advice>
    </aspect>

    <translet name="hello">
        <description>
            sampleAction 빈에서 helloWorld 메쏘드를 실행합니다.
            helloWorld 메쏘드가 반환하는 "Hello, World." 문자열을 텍스트 형식의 컨텐츠로 응답합니다.
        </description>
        <transform type="transform/text">
            <action id="helloData" bean="sampleAction" method="helloWorld"/>
        </transform>
    </translet>

    <translet name="echo1">
        <description style="apon">
            |It accepts parameters and print them to the console.
        </description>
        <parameters>
            <item name="param1" mandatory="false"/>
            <item name="param2" mandatory="true"/>
        </parameters>
        <transform type="transform/text">
            <template engine="token" style="apon">
                |----------------------------------------------------------
                |The parameters you entered are:
                |   param1: ${param1}
                |   param2: ${param2}
                |----------------------------------------------------------
            </template>
        </transform>
    </translet>

    <translet name="echo2">
        <description style="apon">
            |
            |   It accepts parameters and print them to the console.
            |
        </description>
        <parameters>
            <item name="param1" mandatory="true">${prefix} - 1</item>
            <item name="param2">${prefix} - 2</item>
            <item name="param3">${prefix} - 3</item>
        </parameters>
        <transform type="transform/text">
            <template engine="token" style="apon">
                |----------------------------------------------------------
                |The parameters you entered are:
                |   param1: ${param1}
                |   param2: ${param2}
                |   param3: ${param3}
                |----------------------------------------------------------
            </template>
        </transform>
    </translet>

    <translet name="echo3">
        <description style="apon">
            |
            |   It accepts parameters and print them to the console.
            |
        </description>
        <parameters>
            <item name="param1">first ${param1:12345}</item>
            <item name="param2">second ${param2:67890}</item>
            <item name="param3" mandatory="true">third ${param3-1} and ${param3-2}</item>
        </parameters>
        <attributes>
            <item name="attr1">fourth ${param4}</item>
        </attributes>
        <transform type="transform/text">
            <template engine="token" style="apon">
                |----------------------------------------------------------
                |The input parameters and attributes are as follows:
                |   param1: ${param1}
                |   param2: ${param2}
                |   param3: ${param3}
                |   attr1: @{attr1}
                |----------------------------------------------------------
            </template>
        </transform>
    </translet>

    <translet name="echo ${text}">
        <transform type="transform/text">
            <template engine="token" style="apon">
                |----------------------------------------------------------
                |${text}
                |----------------------------------------------------------
            </template>
        </transform>
    </translet>

    <translet name="login">
        <description style="apon">
            |
            |   It accepts parameters used for login and print them to the console.
            |
        </description>
        <parameters>
            <item name="id" mandatory="true"/>
            <item name="email" mandatory="true">${id}@${domain}</item>
            <item name="password" security="true" defaultValue="(none)"/>
        </parameters>
        <transform type="transform/text">
            <template style="apon">
                |-------------------------------------------------------------------------
                |You have entered the following parameters for login:
                |   email: ${email}
                |   password: ${password}
                |-------------------------------------------------------------------------
            </template>
        </transform>
    </translet>

    <translet name="chpw">
        <description style="apon">
            |
            |   It accepts parameters for changing the password and print them to the console.
            |
        </description>
        <parameters>
            <item name="email">${emailId}@${emailDomain}</item>
            <item name="password" security="true"/>
            <item name="confirmPassword" security="true"/>
        </parameters>
        <transform type="transform/text">
            <template style="apon">
                |------------------------------------------------------------------------------------
                |You have entered the following parameters for changing the password:
                |   email: ${email}
                |   password: ${password}
                |   confirm password: ${confirmPassword}
                |------------------------------------------------------------------------------------
            </template>
        </transform>
    </translet>

    <append resource="config/shell/freemarker-translets.xml"/>

</aspectran>